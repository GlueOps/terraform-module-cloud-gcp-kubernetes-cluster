# terraform-module-cloud-gcp-kubernetes-cluster

This Terraform module deploys everything needed in GCP to get a kubernetes cluster up and running. This repo should be used in the context of deploying with the [admiral](https://github.com/glueops/admiral) repository.

## Prerequisites

- GCP Project
- Service account with environment variable set.

For more details see: https://github.com/GlueOps/terraform-module-cloud-gcp-kubernetes-cluster/wiki/FAQ


## Terraform Deployment

### Configuration

Create a `captain_configuration.tfvars` configuration file to deploy Kubernetes.  
A reasonable xample configuration for this module, be sure to update `project_id`, required, and `region`, if desired.  The region should be the same as the region for which the quota increase was requested above:

```hcl
kubernetes_cluster_configurations = {
  network_ranges = {
    "kubernetes_pods" : "10.65.0.0/16",
    "kubernetes_services" : "10.64.224.0/20",
    "kubernetes_nodes" : "10.64.64.0/23"
  }
  project_id = "<unique-project-id>"
  region     = "us-central1"
  zonal = true
}
```

### Deployment
To deploy Kubernetes, run the following commands from the root directory of created for this deployment:

```bash
terraform -chdir=admiral/kubernetes-cluster/gcp init
terraform -chdir=admiral/kubernetes-cluster/gcp apply -state=$(pwd)/terraform_states/kubernetes-cluster.terraform.tfstate -var-file=$(pwd)/captain_configuration.tfvars
```
